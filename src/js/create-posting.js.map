{"version":3,"sources":["src/create-posting.js"],"names":["UNAUTHORIZED","axios","interceptors","response","use","error","status","localStorage","removeItem","window","location","href","Promise","reject","apiUrl","urlString","url","URL","id","searchParams","get","method","headers","Authorization","getItem","then","res","data","$","val","CompetitionName","fileInput","toBase64","file","resolve","reader","FileReader","readAsDataURL","onload","result","onerror","change","e","img","target","files","prev","remove","attr","hide","before","fadeIn","on","preventDefault","formInput","find","removeClass","next","invalid","each","trim","addClass","after","toastr","info","formData","FormData","prop","append","name","Message","CompetitionId","ImagePath","Quote","catch"],"mappings":"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","sourcesContent":["import $ from 'jquery'\nimport axios from 'axios'\nimport toastr from 'toastr'\nconst UNAUTHORIZED = 401\naxios.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    const {\n      status\n    } = error.response\n    if (status === UNAUTHORIZED) {\n      localStorage.removeItem('accessToken')\n      window.location.href = '/login.html'\n    }\n    return Promise.reject(error)\n  }\n)\nconst apiUrl = 'http://192.168.43.211:44396/'\nconst urlString = window.location.href\nconst url = new URL(urlString)\nconst id = url.searchParams.get('id')\n\n\naxios({\n  method: 'get',\n  url: `${apiUrl}/api/Competitions/${id}`,\n  headers: {\n    Authorization: `bearer ${localStorage.getItem('accessToken')}`\n  }\n})\n  .then((res) => {\n    if (res && res.data) {\n      const data = res.data\n      $('#Compertition').val(data.CompetitionName)\n    }\n  })\nconst fileInput = $('#file-input')\nconst toBase64 = (file) => new Promise((resolve, reject) => {\n  const reader = new FileReader()\n  reader.readAsDataURL(file)\n  reader.onload = () => resolve(reader.result)\n  reader.onerror = (error) => reject(error)\n})\nfileInput.change(function (e) {\n  const img = $('<img style=\"display: block\" class=\"img-fluid\"/>')\n  toBase64(e.target.files[0]).then((res) => {\n    $(this).prev().remove()\n    img.attr('src', res)\n    img.hide()\n    $(this).before(img)\n    img.fadeIn()\n  })\n})\n$('#createPosting').on('submit', (e) => {\n  e.preventDefault()\n  const formInput = $('#createPosting').find('.form-control')\n  formInput.removeClass('is-invalid')\n  formInput.next().remove()\n  const data = {}\n  let invalid = false\n  formInput.each(function () {\n    if (!$(this).val().trim()) {\n      invalid = true\n      $(this).addClass('is-invalid')\n      $(this).after($('<div class=\"invalid-feedback\">This field is required!</div>'))\n    } else {\n      data[$(this).attr('name')] = $(this).val().trim()\n    }\n  })\n  if (!invalid) {\n    toastr.info('Uploading image...')\n    const formData = new FormData()\n    const file = $('#file-input').prop('files')[0]\n    formData.append('image', file, file.name)\n    axios({\n      method: 'post',\n      url: `${apiUrl}Postings/UploadImage`,\n      headers: {\n        Authorization: `bearer ${localStorage.getItem('accessToken')}`,\n        'Content-Type': 'multipart/form-data'\n      },\n      data: formData\n    })\n      .then((res) => {\n        if (res && res.data && res.data.Message) {\n          axios({\n            method: 'post',\n            url: `${apiUrl}/api/Postings`,\n            headers: {\n              Authorization: `bearer ${localStorage.getItem('accessToken')}`\n            },\n            data: {\n              CompetitionId: id,\n              ImagePath: `Image/${res.data.Message}`,\n              Quote: $('#textarea-input').val()\n            }\n          })\n            .then(() => {\n              window.location.href = '/admin/posting.html'\n            })\n        } else {\n          toastr.error('Upload file failed!')\n        }\n      })\n      .catch(() => toastr.error('Upload file failed!'))\n  }\n})\n\n"],"file":"create-posting.js"}